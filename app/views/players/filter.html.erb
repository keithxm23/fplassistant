<%- model_class = Player -%>
<div class="page-header">
  <h1>Welcome to FPL Assistant</h1>
  <p>This app is still a work-in-progress. The end goal is to have an app that provides
insightful information to Fantasy Premier League Managers so as to enable them to pick
better teams.</p>
</div>

<div id="gridContainer">
  <table id="filterGrid">
    <tr>
      <td></td>
    </tr>
  </table> 
  <div id="pager"></div>
</div>
<% content_for :css do %>
  <style>
    .ui-pg-input {width: auto !important; }
    
    .ui-pg-selbox {
      width: auto !important; 
      padding: 0 !important;
    }
    
    .searchFilter select, input {
      width: auto !important; 
      
    }
  </style>
<% end %>
<% content_for :js do %>
  <script type="text/javascript">
    
  $(function () {
      numberSearchOptions = ['eq', 'ne', 'le', 'ge', 'nu', 'nn'],
      numberTemplate = {formatter: 'number', align: 'right', sorttype: 'number', width: 50,
                        searchoptions: { sopt: numberSearchOptions }},

      $("#filterGrid").jqGrid({
          url: "/players.json",
          datatype: "json",
          colNames: ["Picture", "First Name", "Last Name", "Position", "", "Team", "Cost"],
          colModel: [
            { name: "photo_mobile_url", width: 100, align: 'center', formatter: playerPicFormatter, search: false },
            { name: "first_name" },
            { name: "second_name" },
            { name: "type_name", width: 100, align: 'center',
             stype:'select', edittype: 'select', 
             searchoptions:{sopt:['eq','ne'], value:":All;Goalkeeper:Goalkeeper;Defender:Defender;Midfielder:Midfielder;Forward:Forward"},
             editoptions:{value:":All;Goalkeeper:Goalkeeper;Defender:Defender;Midfielder:Midfielder;Forward:Forward"}
            },
            { name: "shirt_mobile_image_url", width: 15, align: 'center', formatter: playerPicFormatter, search: false },
            { name: "team_name", width: 100, align: 'left', 
             stype:'select', edittype: 'select', 
             searchoptions:{sopt:['eq','ne'], value:":All;Arsenal:Arsenal;Aston Villa:Aston Villa;Cardiff City:Cardiff City;Chelsea:Chelsea;Crystal Palace:Crystal Palace;Everton:Everton;Fulham:Fulham;Hull City:Hull City;Liverpool:Liverpool;Man City:Man City;Man Utd:Man Utd;Newcastle:Newcastle;Norwich:Norwich;Southampton:Southampton;Stoke City:Stoke City;Sunderland:Sunderland;Swansea:Swansea;Tottenham:Tottenham;West Brom:West Brom;West Ham:West Ham"},
             editoptions:{value:":All;Arsenal:Arsenal;Aston Villa:Aston Villa;Cardiff City:Cardiff City;Chelsea:Chelsea;Crystal Palace:Crystal Palace;Everton:Everton;Fulham:Fulham;Hull City:Hull City;Liverpool:Liverpool;Man City:Man City;Man Utd:Man Utd;Newcastle:Newcastle;Norwich:Norwich;Southampton:Southampton;Stoke City:Stoke City;Sunderland:Sunderland;Swansea:Swansea;Tottenham:Tottenham;West Brom:West Brom;West Ham:West Ham"}
            },
            { name: "now_cost_float", template: numberTemplate }
          ],
          toppager:true,
          rownumbers: true,
          height: 'auto',
          pager: "#pager",
          rowNum: 20,
          rowList: [10, 20, 30],
          sortname: "now_cost_float",
          sortorder: "desc",
          viewrecords: true,
          gridview: true,
          autoencode: true,
          loadonce: true,
          ignoreCase: true,
          caption: "FPL Assitant Grid"
      }); 
      jQuery("#filterGrid").jqGrid('filterToolbar');
    
      //For docs on options set, refer: http://www.trirand.com/jqgridwiki/doku.php?id=wiki:singe_searching#options
      jQuery("#filterGrid").jqGrid('navGrid','#pager',{del:false,add:false,edit:false,cloneToTop:true},{},{},{},{multipleSearch:true,
                                                                                                 width: 600,                                                                                          closeAfterSearch: true,
                                                                                                 top: 300,
                                                                                                 left: 100,
                                                                                                 searchOnEnter: true});
    
    function playerPicFormatter(cellvalue, options, rowObject) 
    {
      var html = "<img src='"+cellvalue+"'/>";
      return html;
    }
  }); 
  </script>
<% end %>
